<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>测试 LibreOffice SDK 开发环境配置(Windows) | Ravenq 的个人博客</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.4e1e9e1f.css" as="style"><link rel="preload" href="/assets/js/app.567b3485.js" as="script"><link rel="preload" href="/assets/js/8.c62eea19.js" as="script"><link rel="prefetch" href="/assets/js/10.c86c1ca0.js"><link rel="prefetch" href="/assets/js/11.bcdb929e.js"><link rel="prefetch" href="/assets/js/12.966ff564.js"><link rel="prefetch" href="/assets/js/13.f65adc85.js"><link rel="prefetch" href="/assets/js/14.fc5fe175.js"><link rel="prefetch" href="/assets/js/15.a92a3e8f.js"><link rel="prefetch" href="/assets/js/16.ffb21bb3.js"><link rel="prefetch" href="/assets/js/17.011882c9.js"><link rel="prefetch" href="/assets/js/18.3daa6950.js"><link rel="prefetch" href="/assets/js/19.30d0e839.js"><link rel="prefetch" href="/assets/js/2.7fdb2499.js"><link rel="prefetch" href="/assets/js/20.f8913486.js"><link rel="prefetch" href="/assets/js/21.e172f780.js"><link rel="prefetch" href="/assets/js/22.8218cd5f.js"><link rel="prefetch" href="/assets/js/23.0d158be2.js"><link rel="prefetch" href="/assets/js/24.f07f4e44.js"><link rel="prefetch" href="/assets/js/25.de8c7777.js"><link rel="prefetch" href="/assets/js/26.0374c741.js"><link rel="prefetch" href="/assets/js/27.a2b7c06e.js"><link rel="prefetch" href="/assets/js/28.435dd0d7.js"><link rel="prefetch" href="/assets/js/29.06af7a50.js"><link rel="prefetch" href="/assets/js/3.5196bfa7.js"><link rel="prefetch" href="/assets/js/30.eb1913d5.js"><link rel="prefetch" href="/assets/js/31.f4394e88.js"><link rel="prefetch" href="/assets/js/32.668dffff.js"><link rel="prefetch" href="/assets/js/33.e0fa4c55.js"><link rel="prefetch" href="/assets/js/34.71408e4e.js"><link rel="prefetch" href="/assets/js/35.be231ec0.js"><link rel="prefetch" href="/assets/js/36.f4ce2254.js"><link rel="prefetch" href="/assets/js/4.4b39041d.js"><link rel="prefetch" href="/assets/js/5.26404c51.js"><link rel="prefetch" href="/assets/js/6.1f1bba03.js"><link rel="prefetch" href="/assets/js/7.e3349a13.js"><link rel="prefetch" href="/assets/js/9.aed313c3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4e1e9e1f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Ravenq 的个人博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>测试 LibreOffice SDK 开发环境配置(Windows)</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog.md/13.html#下载与安装" class="sidebar-link">下载与安装</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog.md/13.html#环境设置" class="sidebar-link">环境设置</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog.md/13.html#编译例子" class="sidebar-link">编译例子</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="测试-libreoffice-sdk-开发环境配置-windows"><a href="#测试-libreoffice-sdk-开发环境配置-windows" aria-hidden="true" class="header-anchor">#</a> 测试 LibreOffice SDK 开发环境配置(Windows)</h1> <h2 id="下载与安装"><a href="#下载与安装" aria-hidden="true" class="header-anchor">#</a> 下载与安装</h2> <p>LibreOffice 主页：<a href="http://zh-cn.libreoffice.org/" target="_blank" rel="noopener noreferrer">http://zh-cn.libreoffice.org/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
下载主程序和 SDK
<img src="http://img.blog.csdn.net/20150421151709513" alt="down load sdk"></p> <p>安装过程就不说了。。。
上几张目录结构图
<img src="http://img.blog.csdn.net/20150421152319031" alt="tree-1"> <img src="http://img.blog.csdn.net/20150421152328157" alt="tree2"></p> <p>需要的工具：</p> <ol><li>jdk: <a href="http://java.sun.com/products." target="_blank" rel="noopener noreferrer">http://java.sun.com/products.<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>vs: 版本不要太低</li> <li>Microsoft .NET Framework SDK</li> <li>GNU make (3.79.1 or higher)使用 MinGW 或者是 Cygwin <a href="http://www.mingw.org/wiki/Getting_Started" target="_blank" rel="noopener noreferrer">http://www.mingw.org/wiki/Getting_Started<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>zip tool (2.3 or higher) <a href="http://www.info-zip.org." target="_blank" rel="noopener noreferrer">http://www.info-zip.org.<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>cat and sed tools <a href="http://sourceforge.net/projects/unxutils/files/latest/download." target="_blank" rel="noopener noreferrer">http://sourceforge.net/projects/unxutils/files/latest/download.<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br>
说明： 其中 make 和 cat sed 在 MinGW 或者 Cygwin 中都可以安装，理论上用里面的也可以，没有试验过。有空试验下。。。</li></ol> <h2 id="环境设置"><a href="#环境设置" aria-hidden="true" class="header-anchor">#</a> 环境设置</h2> <p>在 cmd 中打开 setsdkenv_windows.bat</p> <p><img src="http://img.blog.csdn.net/20150421203639413" alt="这里写图片描述"></p> <p>如果你出现这个，那么恭喜你，你需要手动修改调试这个脚本，这里只说下方法，因为经测试每个机器上的错误地方都不同（吐槽一下 Windows 的脚本，跟 Bash 比简直弱到爆。。。）</p> <p><img src="http://img.blog.csdn.net/20150421203903526" alt="这里写图片描述"></p> <p>在 C:\Users&lt;你的用户名&gt;\AppData\Roaming\libreoffice4.4_sdk 目录下找到 setsdkenv_windows.bat 文件</p> <p><img src="http://img.blog.csdn.net/20150421211104888" alt="img"></p> <p>注释掉 @echo off 然后你就可以看到所有输出，找到有问题的语句然后，循环继续。懂 bat 童鞋无视 -&gt;_-&gt;</p> <p><img src="http://img.blog.csdn.net/20150421211441127" alt="这里写图片描述"> <img src="http://img.blog.csdn.net/20150421210646480" alt="这里写图片描述"></p> <p>调试成功以后，根据提示输入各个环境（其实你也可以手动修改脚本，稍微看一下脚本内容就知道，无非是一些环境变量的设置），最后得到这个结果：
<img src="http://img.blog.csdn.net/20150421211557310" alt="这里写图片描述"></p> <h2 id="编译例子"><a href="#编译例子" aria-hidden="true" class="header-anchor">#</a> 编译例子</h2> <p>sdk 下有几个例子，其中 CPP 是 C++ 的例子，其他例子也可以编译玩玩。这里只简要介绍一下 CPP 里的例子的编译(因为编译后会得到一些头文件，后续会用到 ^_^)
cd 到 DocumentLoad 目录下执行 make</p> <p><img src="http://img.blog.csdn.net/20150421213029000" alt="这里写图片描述"></p> <p>注意：编译后生成了一些头文件后面会用到： &lt;你设置的输出路径&gt;\WINexample.out\inc，我们把它考到 sdk 的目录下，重命名为 includecpp</p> <p>好了，其实这都是准备工作，后续我会实现两个程序把 LibreOffice 嵌入到 MFC 的 View 中，和 C# 的 Winform 中 ^_^, 就酱。。。</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.567b3485.js" defer></script><script src="/assets/js/8.c62eea19.js" defer></script>
  </body>
</html>
