<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linux Programing -- ch8 -- MySQL | Ravenq 的技术博客</title>
    <meta name="description" content="Ravenq 的技术博客文章在Github的备份，博客请访问 http://www.aqcoder.com">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <script src="/baidu-tongji.js"></script>
    
    <link rel="preload" href="/assets/css/0.styles.3e1d0bd1.css" as="style"><link rel="preload" href="/assets/js/app.51606a27.js" as="script"><link rel="preload" href="/assets/js/11.d70cbb59.js" as="script"><link rel="prefetch" href="/assets/js/10.4f2293f7.js"><link rel="prefetch" href="/assets/js/12.151050ff.js"><link rel="prefetch" href="/assets/js/13.98e327e5.js"><link rel="prefetch" href="/assets/js/14.52657d5b.js"><link rel="prefetch" href="/assets/js/15.f29c78b3.js"><link rel="prefetch" href="/assets/js/16.9b42233c.js"><link rel="prefetch" href="/assets/js/17.d76eead4.js"><link rel="prefetch" href="/assets/js/18.1b44fce2.js"><link rel="prefetch" href="/assets/js/19.0f22874b.js"><link rel="prefetch" href="/assets/js/2.d8f505d4.js"><link rel="prefetch" href="/assets/js/20.3a8af0fd.js"><link rel="prefetch" href="/assets/js/21.2f43bfd2.js"><link rel="prefetch" href="/assets/js/22.3badefaf.js"><link rel="prefetch" href="/assets/js/23.18fc0677.js"><link rel="prefetch" href="/assets/js/24.e105e5c1.js"><link rel="prefetch" href="/assets/js/25.cc3cb185.js"><link rel="prefetch" href="/assets/js/26.b7c250e7.js"><link rel="prefetch" href="/assets/js/27.8dd3530f.js"><link rel="prefetch" href="/assets/js/28.9d33d417.js"><link rel="prefetch" href="/assets/js/29.8f06f09e.js"><link rel="prefetch" href="/assets/js/3.c6841776.js"><link rel="prefetch" href="/assets/js/30.b023db8f.js"><link rel="prefetch" href="/assets/js/31.a90f5739.js"><link rel="prefetch" href="/assets/js/32.b6228d44.js"><link rel="prefetch" href="/assets/js/33.7e81152c.js"><link rel="prefetch" href="/assets/js/34.73fdaf57.js"><link rel="prefetch" href="/assets/js/35.199987dd.js"><link rel="prefetch" href="/assets/js/36.fc41b221.js"><link rel="prefetch" href="/assets/js/37.2b1488f7.js"><link rel="prefetch" href="/assets/js/38.5eebeb55.js"><link rel="prefetch" href="/assets/js/39.17dc21f4.js"><link rel="prefetch" href="/assets/js/4.598b8edd.js"><link rel="prefetch" href="/assets/js/40.b004f268.js"><link rel="prefetch" href="/assets/js/41.91fe007f.js"><link rel="prefetch" href="/assets/js/42.9601bf73.js"><link rel="prefetch" href="/assets/js/43.6b2b44e7.js"><link rel="prefetch" href="/assets/js/44.d8da8fdf.js"><link rel="prefetch" href="/assets/js/45.77dedbc5.js"><link rel="prefetch" href="/assets/js/46.84f06670.js"><link rel="prefetch" href="/assets/js/47.97b49389.js"><link rel="prefetch" href="/assets/js/48.efe7b71f.js"><link rel="prefetch" href="/assets/js/5.bf80c919.js"><link rel="prefetch" href="/assets/js/6.ae73b9ef.js"><link rel="prefetch" href="/assets/js/7.86c46139.js"><link rel="prefetch" href="/assets/js/8.302c640d.js"><link rel="prefetch" href="/assets/js/9.f519f576.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3e1d0bd1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Ravenq 的技术博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://www.aqcoder.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/markdown-it-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  markdown-it-vue
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/vue-cli-plugin-component-lib" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue-cli-plugin-component-lib
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>GVF Project</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-server" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-server
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-client" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-client
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-admin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://www.github.com/ravenq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://www.aqcoder.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/markdown-it-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  markdown-it-vue
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/vue-cli-plugin-component-lib" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue-cli-plugin-component-lib
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>GVF Project</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-server" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-server
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-client" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-client
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-admin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://www.github.com/ravenq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Linux Programing -- ch8 -- MySQL</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog.md/16.html#_1-配置文件路径" class="sidebar-link">1. 配置文件路径</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog.md/16.html#_2-查看变量" class="sidebar-link">2. 查看变量</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog.md/16.html#_3-修改密码" class="sidebar-link">3. 修改密码</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog.md/16.html#_4-导出数据" class="sidebar-link">4. 导出数据</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog.md/16.html#_5-数据类型" class="sidebar-link">5.数据类型</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog.md/16.html#_6-apis" class="sidebar-link">6. APIs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog.md/16.html#_1-例程" class="sidebar-link">1. 例程</a></li><li class="sidebar-sub-header"><a href="/blog.md/16.html#_2-连接数据库" class="sidebar-link">2. 连接数据库</a></li><li class="sidebar-sub-header"><a href="/blog.md/16.html#_3-数据库连接选项" class="sidebar-link">3. 数据库连接选项</a></li><li class="sidebar-sub-header"><a href="/blog.md/16.html#_4-错误处理" class="sidebar-link">4. 错误处理</a></li><li class="sidebar-sub-header"><a href="/blog.md/16.html#_5-执行-sql-语句" class="sidebar-link">5. 执行 SQL 语句</a></li><li class="sidebar-sub-header"><a href="/blog.md/16.html#_5-自动插入内容" class="sidebar-link">5. 自动插入内容</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="linux-programing-ch8-mysql"><a href="#linux-programing-ch8-mysql" aria-hidden="true" class="header-anchor">#</a> Linux Programing -- ch8 -- MySQL</h1> <h2 id="_1-配置文件路径"><a href="#_1-配置文件路径" aria-hidden="true" class="header-anchor">#</a> 1. 配置文件路径</h2> <div class="language-shell extra-class"><pre class="language-text"><code>/etc/mysql/my.cnf
</code></pre></div><h2 id="_2-查看变量"><a href="#_2-查看变量" aria-hidden="true" class="header-anchor">#</a> 2. 查看变量</h2> <div class="language-shell extra-class"><pre class="language-text"><code>mysqladmin variables
</code></pre></div><h2 id="_3-修改密码"><a href="#_3-修改密码" aria-hidden="true" class="header-anchor">#</a> 3. 修改密码</h2> <div class="language-shell extra-class"><pre class="language-text"><code>mysqladmin -u root password newpassword
</code></pre></div><p>(这种方法会泄密，shell 历史记录)</p> <div class="language-shell extra-class"><pre class="language-text"><code>mysql&gt;SET password=PASSWORD('yourpassword')
</code></pre></div><h2 id="_4-导出数据"><a href="#_4-导出数据" aria-hidden="true" class="header-anchor">#</a> 4. 导出数据</h2> <div class="language-shell extra-class"><pre class="language-text"><code>mysqldump -u root -p dbname &gt; backup.dump
</code></pre></div><h2 id="_5-数据类型"><a href="#_5-数据类型" aria-hidden="true" class="header-anchor">#</a> 5.数据类型</h2> <table><thead><tr><th>定义</th> <th>说明</th></tr></thead> <tbody><tr><td>CHAR</td> <td>单字符</td></tr> <tr><td>CHAR(N)</td> <td>正好有 N 个字符到字符串，如果必要会议空格字符填充，限制为 255</td></tr> <tr><td>VARCHAR(N)</td> <td>N 个字符到可变长数组，限制为 255 个字符</td></tr> <tr><td>TINYTEXT</td> <td>类似 VARCHAR(N)</td></tr> <tr><td>MEDIUMTEXT</td> <td>最长为 65535 个字符到文本字符串</td></tr> <tr><td>LONGTEXT</td> <td>最长为 2 的 32 次方 -1 个字符到文本字符串</td></tr> <tr><td>TINYINT</td> <td>8 位整型</td></tr> <tr><td>SMALLINT</td> <td>16 位整型</td></tr> <tr><td>MEDIUMINT</td> <td>24 位整型</td></tr> <tr><td>INIT</td> <td>64 位整型</td></tr> <tr><td>BIGINT</td> <td>64 位整型</td></tr> <tr><td>FLOAT(P)</td> <td>浮点型，精度至少为 P 位数字</td></tr> <tr><td>DOUBLE(D,N)</td> <td>浮点型，有符号双精度浮点，有 D 位数字和 N 位小数</td></tr> <tr><td>NUMERIC(P,S)</td> <td>浮点型，总长为 P 位到真实数字，小数点后有 S 位数字， 与 DOUBLE 不同，这是一个准确到数，因此适合用来储存货币值，但处理效率会低一点</td></tr> <tr><td>DECIMAL(P,S)</td> <td>浮点型，与 NUMERIC 同义</td></tr></tbody></table> <h2 id="_6-apis"><a href="#_6-apis" aria-hidden="true" class="header-anchor">#</a> 6. APIs</h2> <h3 id="_1-例程"><a href="#_1-例程" aria-hidden="true" class="header-anchor">#</a> 1. 例程</h3> <div class="language-C extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;mysql/mysql.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    MYSQL <span class="token operator">*</span>conn_ptr<span class="token punctuation">;</span>
    conn_ptr <span class="token operator">=</span> <span class="token function">mysql_init</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>conn_ptr<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;mysql_int failed\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> EXIT_FAILURE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    conn_ptr <span class="token operator">=</span> <span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>conn_ptr<span class="token punctuation">,</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>conn_ptr<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Connection success\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Connection failed\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">mysql_close</span><span class="token punctuation">(</span>conn_ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> EXIT_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-连接数据库"><a href="#_2-连接数据库" aria-hidden="true" class="header-anchor">#</a> 2. 连接数据库</h3> <div class="language-C extra-class"><pre class="language-c"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;mysql.h&gt;</span></span>

MYSQL <span class="token operator">*</span><span class="token function">mysql_init</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

MYSQL <span class="token operator">*</span><span class="token function">mysql_real_connect</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>connection<span class="token punctuation">,</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>servar_host<span class="token punctuation">,</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>sql_user_name<span class="token punctuation">,</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>sql_password<span class="token punctuation">,</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>db_name<span class="token punctuation">,</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> port_number<span class="token punctuation">,</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>unix_socket_name<span class="token punctuation">,</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">mysql_close</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-数据库连接选项"><a href="#_3-数据库连接选项" aria-hidden="true" class="header-anchor">#</a> 3. 数据库连接选项</h3> <div class="language-C extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">mysql_options</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>connection<span class="token punctuation">,</span> <span class="token keyword">enum</span> <span class="token class-name">option_to_set</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>argument<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>连接选项只能在 mysql_init 和 mysql_real_connct 之间调用，每次只能设置一个选项</p> <table><thead><tr><th>enum 选项</th> <th>实际参数类型</th> <th>说明</th></tr></thead> <tbody><tr><td>MySQL_OPT_CONNECT_TIMEOUT</td> <td>const unsigned int *</td> <td>连接超时等待</td></tr> <tr><td>MySQL_OPT_COMPRESS</td> <td>NULL</td> <td>网络连接中使用压缩机制</td></tr> <tr><td>MySQL_OPT_COMMAND</td> <td>const char *</td> <td>每次连接建立后发送的命令</td></tr></tbody></table> <h3 id="_4-错误处理"><a href="#_4-错误处理" aria-hidden="true" class="header-anchor">#</a> 4. 错误处理</h3> <div class="language-C extra-class"><pre class="language-c"><code><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">mysql_errno</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">mysql_error</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_5-执行-sql-语句"><a href="#_5-执行-sql-语句" aria-hidden="true" class="header-anchor">#</a> 5. 执行 SQL 语句</h3> <p>执行查询, 其中 mysql_query 不能查询二进制字段</p> <div class="language-C extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>mysql<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>stmt_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">mysql_real_query</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>mysql<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> stmt_str<span class="token punctuation">)</span>
</code></pre></div><p>获取受影响数</p> <div class="language-C extra-class"><pre class="language-c"><code>my_ulonglong <span class="token function">mysql_affected_rows</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>mysql<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>返回受影响行数，注意：只查询有修改的行数，如果需要返回传统的匹配的行数连接时使用标记：<code>CLIENT_FOUND_ROWS</code></p> <h3 id="_5-自动插入内容"><a href="#_5-自动插入内容" aria-hidden="true" class="header-anchor">#</a> 5. 自动插入内容</h3> <p>当使用了<code>AUTO_INCREMENT</code>选项建表后，可以使用<code>LAST_INSERT_ID()</code>获取插入的内容</p> <div class="language-mysql extra-class"><pre class="language-text"><code>CREATE TABLE children(
    childno INTEGER AUTO_INCREMENT NOT NULLPRIMARY KEY,
    fname VARCHAR(10),
    age INTEGER
);

mysql&gt;SELECT LAST_INSERT_ID();
</code></pre></div><p>获取结果，mysql_store_result 为一次获取结果，mysql_use_result 为游标方式</p> <div class="language-mysql extra-class"><pre class="language-text"><code>MYSQL_RES *mysql_store_result(MYSQL *mysql);
MYSQL_RES *mysql_use_result(MYSQL *mysql);
void mysql_free_result(MYSQL *result);
</code></pre></div><p>游标定位 &amp; 行数获取</p> <div class="language-C extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">mysql_data_seek</span><span class="token punctuation">(</span>MYSQL_RES <span class="token operator">*</span>result<span class="token punctuation">,</span> my_ulonglong offset<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// offset 为行号</span>
MYSQL_ROW_OFFSET <span class="token function">mysql_row_tell</span><span class="token punctuation">(</span>MYSQL_RES <span class="token operator">*</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取当前位置，注意不是行号，只能用于 mysql_store_result</span>
MYSQL_ROW_OFFSET <span class="token function">mysql_row_seek</span><span class="token punctuation">(</span>MYSQL_RES <span class="token operator">*</span>result<span class="token punctuation">,</span> MYSQL_ROW_OFFSET offset<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 移动当前位置，返回之前位置, 只能用于 mysql_store_result</span>
my_ulonglong <span class="token function">mysql_num_rows</span><span class="token punctuation">(</span>MYSQL_RESS <span class="token operator">*</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取行数，只能用于 mysql_store_result</span>
</code></pre></div><p>提取行 &amp; 获取行字段数</p> <div class="language-C extra-class"><pre class="language-c"><code>MYSQL_ROW <span class="token function">mysql_fetch_row</span><span class="token punctuation">(</span>MYSQL_RES <span class="token operator">*</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">mysql_field_count</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>mysql<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>提取字段信息</p> <div class="language-C extra-class"><pre class="language-c"><code>MYSQL_FIELD <span class="token operator">*</span><span class="token function">mysql_fetch_field</span><span class="token punctuation">(</span>MYSQL_RES <span class="token operator">*</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
MYSQL_FIELD_OFFSET <span class="token function">mysql_field_seek</span><span class="token punctuation">(</span>MYSQL <span class="token operator">*</span>result<span class="token punctuation">,</span> MYSQL_FIELD_OFFSET offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
MYSQL <span class="token operator">*</span><span class="token function">mysql_fetch_field</span><span class="token punctuation">(</span>MYSQL_RES <span class="token operator">*</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>MYSQL_FIELD 结构定义</p> <div class="language-C extra-class"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">st_mysql_field</span> <span class="token punctuation">{</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>                 <span class="token comment">/* Name of column */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>org_name<span class="token punctuation">;</span>             <span class="token comment">/* Original column name, if an alias */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>table<span class="token punctuation">;</span>                <span class="token comment">/* Table of column if column was a field */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>org_table<span class="token punctuation">;</span>            <span class="token comment">/* Org table name, if table was an alias */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>db<span class="token punctuation">;</span>                   <span class="token comment">/* Database for table */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>catalog<span class="token punctuation">;</span>          <span class="token comment">/* Catalog for table */</span>
  <span class="token keyword">char</span> <span class="token operator">*</span>def<span class="token punctuation">;</span>                  <span class="token comment">/* Default value (set by mysql_list_fields) */</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">long</span> length<span class="token punctuation">;</span>       <span class="token comment">/* Width of column (create length) */</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">long</span> max_length<span class="token punctuation">;</span>   <span class="token comment">/* Max width for selected set */</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> name_length<span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> org_name_length<span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> table_length<span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> org_table_length<span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> db_length<span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> catalog_length<span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> def_length<span class="token punctuation">;</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> flags<span class="token punctuation">;</span>         <span class="token comment">/* Div flags */</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> decimals<span class="token punctuation">;</span>      <span class="token comment">/* Number of decimals in field */</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> charsetnr<span class="token punctuation">;</span>     <span class="token comment">/* Character set */</span>
  <span class="token keyword">enum</span> <span class="token class-name">enum_field_types</span> type<span class="token punctuation">;</span> <span class="token comment">/* Type of field. See mysql_com.h for types */</span>
  <span class="token keyword">void</span> <span class="token operator">*</span>extension<span class="token punctuation">;</span>
<span class="token punctuation">}</span> MYSQL_FIELD<span class="token punctuation">;</span>

<span class="token keyword">enum</span> <span class="token class-name">enum_field_types</span> <span class="token punctuation">{</span> MYSQL_TYPE_DECIMAL<span class="token punctuation">,</span> MYSQL_TYPE_TINY<span class="token punctuation">,</span>
    MYSQL_TYPE_SHORT<span class="token punctuation">,</span>  MYSQL_TYPE_LONG<span class="token punctuation">,</span>
    MYSQL_TYPE_FLOAT<span class="token punctuation">,</span>  MYSQL_TYPE_DOUBLE<span class="token punctuation">,</span>
    MYSQL_TYPE_NULL<span class="token punctuation">,</span>   MYSQL_TYPE_TIMESTAMP<span class="token punctuation">,</span>
    MYSQL_TYPE_LONGLONG<span class="token punctuation">,</span>MYSQL_TYPE_INT24<span class="token punctuation">,</span>
    MYSQL_TYPE_DATE<span class="token punctuation">,</span>   MYSQL_TYPE_TIME<span class="token punctuation">,</span>
    MYSQL_TYPE_DATETIME<span class="token punctuation">,</span> MYSQL_TYPE_YEAR<span class="token punctuation">,</span>
    MYSQL_TYPE_NEWDATE<span class="token punctuation">,</span> MYSQL_TYPE_VARCHAR<span class="token punctuation">,</span>
    MYSQL_TYPE_BIT<span class="token punctuation">,</span>
    MYSQL_TYPE_TIMESTAMP2<span class="token punctuation">,</span>
    MYSQL_TYPE_DATETIME2<span class="token punctuation">,</span>
    MYSQL_TYPE_TIME2<span class="token punctuation">,</span>
                    MYSQL_TYPE_NEWDECIMAL<span class="token operator">=</span><span class="token number">246</span><span class="token punctuation">,</span>
    MYSQL_TYPE_ENUM<span class="token operator">=</span><span class="token number">247</span><span class="token punctuation">,</span>
    MYSQL_TYPE_SET<span class="token operator">=</span><span class="token number">248</span><span class="token punctuation">,</span>
    MYSQL_TYPE_TINY_BLOB<span class="token operator">=</span><span class="token number">249</span><span class="token punctuation">,</span>
    MYSQL_TYPE_MEDIUM_BLOB<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span>
    MYSQL_TYPE_LONG_BLOB<span class="token operator">=</span><span class="token number">251</span><span class="token punctuation">,</span>
    MYSQL_TYPE_BLOB<span class="token operator">=</span><span class="token number">252</span><span class="token punctuation">,</span>
    MYSQL_TYPE_VAR_STRING<span class="token operator">=</span><span class="token number">253</span><span class="token punctuation">,</span>
    MYSQL_TYPE_STRING<span class="token operator">=</span><span class="token number">254</span><span class="token punctuation">,</span>
    MYSQL_TYPE_GEOMETRY<span class="token operator">=</span><span class="token number">255</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>预定义宏 <code>IS_NUM</code> 用于判断是否为数字型</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.51606a27.js" defer></script><script src="/assets/js/11.d70cbb59.js" defer></script>
  </body>
</html>
