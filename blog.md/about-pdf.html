<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>关于 C++ 打印 PDF 打印及 PDF 转图片、合并 | Ravenq 的技术博客</title>
    <meta name="description" content="Ravenq 的技术博客文章在Github的备份，博客请访问 http://www.aqcoder.com">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <script src="/baidu-tongji.js"></script>
    
    <link rel="preload" href="/assets/css/0.styles.3e1d0bd1.css" as="style"><link rel="preload" href="/assets/js/app.4656d413.js" as="script"><link rel="preload" href="/assets/js/36.b3853710.js" as="script"><link rel="prefetch" href="/assets/js/10.89ed444d.js"><link rel="prefetch" href="/assets/js/11.659c9966.js"><link rel="prefetch" href="/assets/js/12.8f4aaac0.js"><link rel="prefetch" href="/assets/js/13.c536b4f2.js"><link rel="prefetch" href="/assets/js/14.21c4f404.js"><link rel="prefetch" href="/assets/js/15.f7408336.js"><link rel="prefetch" href="/assets/js/16.a0e1f3d7.js"><link rel="prefetch" href="/assets/js/17.58743de0.js"><link rel="prefetch" href="/assets/js/18.b1abc7db.js"><link rel="prefetch" href="/assets/js/19.fdf1f22c.js"><link rel="prefetch" href="/assets/js/2.46d463bd.js"><link rel="prefetch" href="/assets/js/20.c6eb0579.js"><link rel="prefetch" href="/assets/js/21.c99260ac.js"><link rel="prefetch" href="/assets/js/22.2c7f300a.js"><link rel="prefetch" href="/assets/js/23.da0a6bc0.js"><link rel="prefetch" href="/assets/js/24.ecf5872c.js"><link rel="prefetch" href="/assets/js/25.f28d9120.js"><link rel="prefetch" href="/assets/js/26.f9920c93.js"><link rel="prefetch" href="/assets/js/27.e36352d5.js"><link rel="prefetch" href="/assets/js/28.1b9de679.js"><link rel="prefetch" href="/assets/js/29.ea5b24c0.js"><link rel="prefetch" href="/assets/js/3.a6acaedf.js"><link rel="prefetch" href="/assets/js/30.4b1b7083.js"><link rel="prefetch" href="/assets/js/31.0df5edb3.js"><link rel="prefetch" href="/assets/js/32.d2acece3.js"><link rel="prefetch" href="/assets/js/33.4da96b10.js"><link rel="prefetch" href="/assets/js/34.5a7dc727.js"><link rel="prefetch" href="/assets/js/35.652458a9.js"><link rel="prefetch" href="/assets/js/37.e21463d2.js"><link rel="prefetch" href="/assets/js/38.82e5c7d6.js"><link rel="prefetch" href="/assets/js/39.9346ccd3.js"><link rel="prefetch" href="/assets/js/4.71a39d4d.js"><link rel="prefetch" href="/assets/js/40.1ed88c2a.js"><link rel="prefetch" href="/assets/js/41.bef4e3c6.js"><link rel="prefetch" href="/assets/js/42.78f8a52e.js"><link rel="prefetch" href="/assets/js/43.4c5babb3.js"><link rel="prefetch" href="/assets/js/44.07ba53fd.js"><link rel="prefetch" href="/assets/js/5.d3f9f931.js"><link rel="prefetch" href="/assets/js/6.3e061d9a.js"><link rel="prefetch" href="/assets/js/7.e3dbe82f.js"><link rel="prefetch" href="/assets/js/8.f7fe650f.js"><link rel="prefetch" href="/assets/js/9.530a603c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3e1d0bd1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Ravenq 的技术博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://www.aqcoder.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/markdown-it-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  markdown-it-vue
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/vue-cli-plugin-component-lib" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue-cli-plugin-component-lib
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>GVF Project</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-server" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-server
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-client" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-client
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-admin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://www.github.com/ravenq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://www.aqcoder.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/markdown-it-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  markdown-it-vue
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/vue-cli-plugin-component-lib" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue-cli-plugin-component-lib
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>GVF Project</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-server" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-server
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-client" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-client
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-admin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://www.github.com/ravenq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>关于 C++ 打印 PDF 打印及 PDF 转图片、合并</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog.md/about-pdf.html#打印" class="sidebar-link">打印</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog.md/about-pdf.html#实现方法一" class="sidebar-link">实现方法一</a></li><li class="sidebar-sub-header"><a href="/blog.md/about-pdf.html#实现方法二" class="sidebar-link">实现方法二</a></li><li class="sidebar-sub-header"><a href="/blog.md/about-pdf.html#方法三" class="sidebar-link">方法三</a></li></ul></li><li><a href="/blog.md/about-pdf.html#合并问题" class="sidebar-link">合并问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog.md/about-pdf.html#文档结构" class="sidebar-link">文档结构</a></li><li class="sidebar-sub-header"><a href="/blog.md/about-pdf.html#图片合并" class="sidebar-link">图片合并</a></li></ul></li><li><a href="/blog.md/about-pdf.html#介绍几个关于-pdf-的实用库" class="sidebar-link">介绍几个关于 PDF 的实用库</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="关于-c-打印-pdf-打印及-pdf-转图片、合并"><a href="#关于-c-打印-pdf-打印及-pdf-转图片、合并" aria-hidden="true" class="header-anchor">#</a> 关于 C++ 打印 PDF 打印及 PDF 转图片、合并</h1> <p>原文: <a href="http://www.aqcoder.com/post/content?id=42" target="_blank" rel="noopener noreferrer">http://www.aqcoder.com/post/content?id=42<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>pdf（Portable Document Format 的简称，意为“便携式文档格式”），是由 Adobe Systems 用于与应用程序、操作系统、硬件无关的方式进行文件交换所发展出的文件格式。PDF 文件以 PostScript 语言图象模型为基础，无论在哪种打印机上都可保证精确的颜色和准确的打印效果，即 PDF 会忠实地再现原稿的每一个字符、颜色以及图象。</p> <p>PDF 设计的初衷是为了解决多平台的打印问题，所以他不像 WORD 那样具有文档流结构，编辑方面没有 WORD 那样强大。</p> <h2 id="打印"><a href="#打印" aria-hidden="true" class="header-anchor">#</a> 打印</h2> <p>需要打印 PDF 自然需要一个打印程序，可以打印 PDF 的程序有很多。Adobe 自家的有 PDF Reader、 Acrobat。商用的有金山 WPS、Foxit Reader。开源的有 xpdf reader 等。</p> <p>当然，作为程序猿我们说的打印自然不是讨论如何使用这些软件打印 PDF。而是这么使用程序打印 PDF。</p> <p>应用场景：第三方给你的系统提供了 PDF 格式的文件，在你的系统中有个打印按钮，点击之后去打印这个 PDF。</p> <h3 id="实现方法一"><a href="#实现方法一" aria-hidden="true" class="header-anchor">#</a> 实现方法一</h3> <p>在客户端上安装一个 PDF 渲染程序（上面的几个 PDF 浏览器/编辑器程序都含有渲染功能），然后使用命令行调用打印。各种语言启动进程的方法这里就不赘述了。</p> <p>显然，这种方法有个很大的缺点，要求客户机上必须安装一个渲染程序，或者吧他的程序包在你的程序包里，这样会有版权问题，还会使你的程序包变大。</p> <h3 id="实现方法二"><a href="#实现方法二" aria-hidden="true" class="header-anchor">#</a> 实现方法二</h3> <p>讲方法二前，我们先来说说网传的一种方法</p> <div class="language-C++ extra-class"><pre class="language-text"><code>if (OpenPrinterA(&quot;Microsoft XPS Document Writer&quot;, &amp;hPrinter, NULL))
{
    if (StartDocPrinterA(hPrinter, 1, (LPBYTE)&amp;di))
    {
        if (StartPagePrinter(hPrinter))
        {
            bSuccess = WritePrinter(hPrinter, buffer, length, &amp;dwWritten);
            EndPagePrinter(hPrinter);
        }
        EndDocPrinter(hPrinter);
    }
    ClosePrinter(hPrinter);
}
if (bSuccess == false)
{
    dwError = GetLastError();
}
</code></pre></div><p>这是 C++ 的实现网上还有一个 C# 的实现。</p> <p><strong>这种方法是行不通的</strong> ，你会发现有的人在帖子里回复何以，有的人回复不可以。这是为什么呢。</p> <p>因为打印机一般只识别打印格式，如 PostScript 格式，而 PDF 格式是在 PostScript 格式之上的。但是有些新型的打印机也会识别 PDF 格式。这就是为什么有的人测试不可以，有的人测试可以的原因。</p> <p>现在我们来讨论方法二。直接发送 PDF 文件到打印机是行不通的，所以只能乖乖的使用打印机 GDI 接口，吧 PDF 渲染到打印机 DC 上。</p> <p>所以使用这个方法的前提是需要一个 PDF 渲染器，pdfium 是 Google  Chromium 的项目的一部分，也是一个 PDF 渲染器，我们可以使用  pdfium 解析 PDF 文件，并渲染到打印机 DC 上。</p> <p>由于这种方法工程量有点大，所以我最终选择了第三种方法。</p> <h3 id="方法三"><a href="#方法三" aria-hidden="true" class="header-anchor">#</a> 方法三</h3> <p>既然使用一个 PDF 渲染器工程量比较大，那么我们是否可以吧 PDF 文件变成图片呢。把图片渲染到打印机 DC 上就很容易了。</p> <div class="language-sh extra-class"><pre class="language-text"><code> -----       ------        -------------
| pdf | --&gt; | image | --&gt; | print DC API |
 -----       ------        -------------
</code></pre></div><p>由于我们后端是用 JAVA 实现的，所以转化这一步自然也可以挪到后端去做，后端我们选择了 <a href="https://pdfbox.apache.org/" target="_blank" rel="noopener noreferrer">Apache PDFBox<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 作为转化库。PDFbox 转化为图片就很容易了：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BufferedImage</span><span class="token punctuation">&gt;</span></span> <span class="token function">toImageList</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> pdf<span class="token punctuation">)</span>
      <span class="token keyword">throws</span> <span class="token class-name">InvalidPasswordException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> dpi <span class="token operator">=</span> <span class="token number">96</span><span class="token punctuation">;</span>
    <span class="token class-name">PDDocument</span> document <span class="token operator">=</span> <span class="token class-name">PDDocument</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>pdf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">PDFRenderer</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDFRenderer</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">;</span>
    renderer<span class="token punctuation">.</span><span class="token function">setSubsamplingAllowed</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BufferedImage</span><span class="token punctuation">&gt;</span></span> ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BufferedImage</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> document<span class="token punctuation">.</span><span class="token function">getNumberOfPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">BufferedImage</span> bi <span class="token operator">=</span> renderer<span class="token punctuation">.</span><span class="token function">renderImageWithDPI</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> dpi<span class="token punctuation">,</span> <span class="token class-name">ImageType</span><span class="token punctuation">.</span>RGB<span class="token punctuation">)</span><span class="token punctuation">;</span>
      ret<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>bi<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    document<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>通过以上代码我们发现 PDFBox 也是一个 PDF 渲染器，但是客户端程序一般不会去用 JAVA 做，若果你的客户端程序是 JAVA 写的，哪可直接使用打印功能了。</p> <p>那么在 C++ 里打印图片功能如何实现呢：</p> <div class="language-C++ extra-class"><pre class="language-text"><code>// data 为图片数据，这里我们使用图片 base64 数据，注意要去掉 base64 头部。
bool PrintImage(const std::string&amp; printer, const std::string&amp; data) {
  bool bAtoFit = true;
  char szDriver [16] = &quot;WINSPOOL&quot;;
  char szPrinter [1024];
  DWORD cchBuffer = 255;
  HDC hdcPrint = NULL;
  HANDLE hPrinter = NULL;
  PRINTER_INFO_2A * pPrinterData;
  BYTE pdBuffer [102400];
  BOOL bReturn = FALSE;

  DWORD cbBuf = sizeof(pdBuffer);
  DWORD cbNeeded = 0;
  pPrinterData =(PRINTER_INFO_2A *)&amp;pdBuffer[0];

  if (printer.empty())
      GetDefaultPrinterA(szPrinter, &amp;cchBuffer);
  else
      strcpy_s(szPrinter, printer.c_str());

  if(!OpenPrinterA(szPrinter, &amp;hPrinter, NULL))
  {
      return false;
  }

  if(GetPrinterA(hPrinter, 2, &amp;pdBuffer[0], cbBuf,&amp;cbNeeded))
      ClosePrinter(hPrinter);
  else
  {
      callback-&gt;Failure(-1, &quot;get printer fail.&quot;);
      return false;
  }

  hdcPrint = CreateDCA(szDriver, szPrinter, pPrinterData-&gt;pPortName, NULL);
  CDC dc;
  if (!dc.Attach(hdcPrint)) {
      callback-&gt;Failure(-1, &quot;No printer found!&quot;);
      return false;
  }

  dc.m_bPrinting = TRUE;
  DOCINFO di;
  // Initialise print document details
  ::ZeroMemory (&amp;di, sizeof (DOCINFO));
  di.cbSize = sizeof (DOCINFO);
  di.lpszDocName = L&quot;cef_print_image&quot;;
  // Begin a new print job
  BOOL bPrintingOK = dc.StartDoc(&amp;di);
  // Get the printing extents
  // and store in the m_rectDraw field of a 
  // CPrintInfo object
  CPrintInfo Info;
  // just one page
  Info.SetMaxPage(1);
  int maxw = dc.GetDeviceCaps(HORZRES);
  int maxh = dc.GetDeviceCaps(VERTRES);
  Info.m_rectDraw.SetRect(0, 0, maxw, maxh);
  for (UINT page = Info.GetMinPage(); page &lt;= Info.GetMaxPage() &amp;&amp; bPrintingOK; page++)
  {
      // begin new page
      dc.StartPage();
      Info.m_nCurPage = page;

      // get bitmap
      CefRefPtr&lt;CefBinaryValue&gt; pData = CefBase64Decode(data);
      size_t lenDes = pData-&gt;GetSize();
      char* pDes = new char[lenDes];
      pData-&gt;GetData(pDes, lenDes, 0);

      BITMAP bm;
      CBitmap* pbmp = NULL;
      HBITMAP Hbitmap = NULL;
      HGLOBAL hMem = ::GlobalAlloc(GMEM_MOVEABLE, lenDes);
      LPVOID pImage = ::GlobalLock(hMem);
      memcpy(pImage, pDes, lenDes);
      IStream* pStream = NULL;
      ::CreateStreamOnHGlobal(hMem, FALSE, &amp;pStream);
      Gdiplus::Bitmap gdi(pStream);
      gdi.GetHBITMAP(NULL, &amp;Hbitmap);
      pbmp = CBitmap::FromHandle(Hbitmap);
      pbmp-&gt;GetBitmap(&amp;bm);

      int w = bm.bmWidth;
      int h = bm.bmHeight;
      float rate = (float)maxw / w;
      // create memory device context
      CDC bmpDC;
      bmpDC.CreateCompatibleDC(&amp;dc);
      bmpDC.SetMapMode(dc.GetMapMode());
      CBitmap *pBmp = bmpDC.SelectObject(pbmp);

      dc.SetStretchBltMode(STRETCH_DELETESCANS);
      // now stretchblt to maximum width on page
      if (bAutoFit)
          dc.StretchBlt(0, 0, maxw, maxh, &amp;bmpDC, 0, 0, w, h, SRCCOPY);
      else
          dc.StretchBlt(0, 0, maxw, int(h * rate), &amp;bmpDC, 0, 0, w, h, SRCCOPY);
      // clean up
      bmpDC.SelectObject(pBmp);
      pStream-&gt;Release();
      GlobalUnlock(hMem);
      GlobalFree(hMem);
      delete[] pDes;
      bPrintingOK = (dc.EndPage() &gt; 0);   // end page
  }

  if (bPrintingOK)
  {
      dc.EndDoc(); // end a print job
      return true;
  }
  else
  {
      dc.AbortDoc();
      return false;
  }
}
</code></pre></div><p>用 C# 实现打印图片的功能估计会更容易一些。</p> <h2 id="合并问题"><a href="#合并问题" aria-hidden="true" class="header-anchor">#</a> 合并问题</h2> <p>有时候我们会遇到需要将多个 PDF 合并到一起，PDFbox 有合并的功能：</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">mergePdf</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">InputStream</span><span class="token punctuation">&gt;</span></span> pdfList<span class="token punctuation">,</span> <span class="token class-name">OutputStream</span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
  <span class="token class-name">PDFMergerUtility</span> merger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDFMergerUtility</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  merger<span class="token punctuation">.</span><span class="token function">addSources</span><span class="token punctuation">(</span>pdfList<span class="token punctuation">)</span><span class="token punctuation">;</span>
  merger<span class="token punctuation">.</span><span class="token function">setDestinationStream</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
  merger<span class="token punctuation">.</span><span class="token function">mergeDocuments</span><span class="token punctuation">(</span><span class="token class-name">MemoryUsageSetting</span><span class="token punctuation">.</span><span class="token function">setupMainMemoryOnly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>假设有两份 PDF 文件 pdf1，pdf2 这两份 PDF 文件都只含有一页，并且内容只有一行文字：</p> <p><img src="https://ravenq-1251588610.cos.ap-guangzhou.myqcloud.com/about-pdf-pdf1.png" alt="pdf1"></p> <p>图 2-1 pdf1</p> <p><img src="https://ravenq-1251588610.cos.ap-guangzhou.myqcloud.com/about-pdf-pdf2.png" alt="pdf2"></p> <p>图 2-2 pdf1</p> <p>合并以后将会得到一份两页的 PDF 文件。这是因为 PDF 并不是 <strong>流式文档结构</strong> 的。</p> <h3 id="文档结构"><a href="#文档结构" aria-hidden="true" class="header-anchor">#</a> 文档结构</h3> <blockquote><p>摘自百度百科</p></blockquote> <p>PDF文件结构主要可以分为四个部分：</p> <p>首部</p> <p>用文本编辑器打开的时候就可以看到：%PDF-1.4 这样的字眼，其中最后一位就是PDF文件格式版本号，软件的版本号总要比文件格式的版本号高1，比如说Read 5能打开的内容就是4。
文件体</p> <p>里面由若干个的obj对象来组成，类似这种形式：</p> <div class="language-text extra-class"><pre class="language-text"><code>3 0 obj
&lt;&lt;
/Type /Pages
/Count 1
/Kids [4 0 R]
&gt;&gt;
endobj
</code></pre></div><p>第一个数字称为对象号，来唯一标识一个对象的，第二个是产生号，是用来表明它在被创建后的第几次修改，所有新创建的PDF文件的产生号应该都是0，即第一次被创建以后没有被修改过。上面的例子就说明该对象的对象号是3，而且创建后没有被修改过。</p> <p>对象的内容应该是包含在&lt;&lt; 和&gt;&gt;之间的，最后以关键字endobj结束。</p> <p>交叉引用表</p> <p>用来索引各个obj 对象在文档中的位置，以实现随机访问，它的形式是：</p> <div class="language-text extra-class"><pre class="language-text"><code>xref
0 8
0000000000 65535f
0000000009 00000n
0000000074 00000 n
0000000120 00000 n
0000000179 00000 n
0000000322 00000 n
0000000415 00000 n
0000000445 00000 n
</code></pre></div><p>xref说明一个交叉引用表的开始，交叉引用表的第一行0 8 说明下面各行所描述的对象号是从0开始，并且有8个对象。</p> <p>0000000000 65535f，一般每个PDF文件都是以这一行开始交叉应用表的，说明对象0的起始地址为0000000000，产生号（generation number）为65535，也是最大产生号，不可以再进行更改，而且最后对象的表示是f, 表明该对象为free, 这里，大家可以看到，其实这个对象可以看作是文件头。</p> <p>0000000009 00000n就是表示对象1，0000000009是其偏移地址，00000为5位产生号（最大为65535），0表明该对象未被修改过, n表示该对象在使用，区别与自由对象(f)，可以更改。</p> <p>尾部</p> <div class="language-text extra-class"><pre class="language-text"><code>Trailer
&lt;&lt;
/Size 8
/Root 1 0 R
&gt;&gt;
startxref
553
%%EOF
</code></pre></div><p>trailer 说明文件尾 trailer对象的开始。</p> <p>/Size 8说明该PDF文件的对象数目。</p> <p>/Root 1 0 R说明根对象的对象号为1。</p> <p>Startxref</p> <p>553说明交叉引用表的偏移地址，从而可以找到PDF文档中所有的对象的相对地址，进而访问对象。</p> <p>%%EOF为文件结束标志。</p> <h3 id="图片合并"><a href="#图片合并" aria-hidden="true" class="header-anchor">#</a> 图片合并</h3> <p>那么我们怎么才能得到我们想要的合并的效果呢，这里有个很土的方法。使用绘制图片的方法，倒着遍历图片，发现像素不是 (255,255,255) 则记录位置，讲下一张图片从这个偏移点开始绘制。最终得到的效果如下：</p> <p><img src="https://ravenq-1251588610.cos.ap-guangzhou.myqcloud.com/about-pdf-merge.png" alt="merge"></p> <p>图 2-3 合并图片</p> <div class="language-JAVA extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BufferedImage</span><span class="token punctuation">&gt;</span></span> <span class="token function">mergeImage</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BufferedImage</span><span class="token punctuation">&gt;</span></span> imgList<span class="token punctuation">,</span> <span class="token class-name">MergeImageOptions</span> options<span class="token punctuation">)</span>
      <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>options <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MergeImageOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BufferedImage</span><span class="token punctuation">&gt;</span></span> ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BufferedImage</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">BufferedImage</span> mergeImg <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> imgWidth <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> imgHeight <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> p <span class="token operator">&lt;</span> imgList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">BufferedImage</span> bi <span class="token operator">=</span> imgList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> width <span class="token operator">=</span> bi<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> height <span class="token operator">=</span> bi<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> minx <span class="token operator">=</span> bi<span class="token punctuation">.</span><span class="token function">getMinX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> miny <span class="token operator">=</span> bi<span class="token punctuation">.</span><span class="token function">getMinY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> realHeight <span class="token operator">=</span> height<span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> done <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&gt;</span> miny<span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> minx<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> width<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> pixel <span class="token operator">=</span> bi<span class="token punctuation">.</span><span class="token function">getRGB</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token punctuation">(</span>pixel <span class="token operator">&amp;</span> <span class="token number">0xff0000</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> g <span class="token operator">=</span> <span class="token punctuation">(</span>pixel <span class="token operator">&amp;</span> <span class="token number">0xff00</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token punctuation">(</span>pixel <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">!=</span> <span class="token number">255</span> <span class="token operator">||</span> g <span class="token operator">!=</span> <span class="token number">255</span> <span class="token operator">||</span> b <span class="token operator">!=</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          realHeight <span class="token operator">=</span> j<span class="token punctuation">;</span>
          done <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      imgWidth <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>imgWidth<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
      imgHeight <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>imgHeight<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>mergeImg <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>offset <span class="token operator">+</span> realHeight<span class="token punctuation">)</span> <span class="token operator">&gt;</span> imgHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      mergeImg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedImage</span><span class="token punctuation">(</span>imgWidth<span class="token punctuation">,</span> imgHeight<span class="token punctuation">,</span> <span class="token class-name">BufferedImage</span><span class="token punctuation">.</span>TYPE_INT_RGB<span class="token punctuation">)</span><span class="token punctuation">;</span>
      ret<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mergeImg<span class="token punctuation">)</span><span class="token punctuation">;</span>
      offset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Graphics</span> g <span class="token operator">=</span> mergeImg<span class="token punctuation">.</span><span class="token function">getGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    g<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>bi<span class="token punctuation">,</span> minx<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    offset <span class="token operator">+=</span> realHeight<span class="token punctuation">;</span>
    g<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="介绍几个关于-pdf-的实用库"><a href="#介绍几个关于-pdf-的实用库" aria-hidden="true" class="header-anchor">#</a> 介绍几个关于 PDF 的实用库</h2> <ul><li><a href="https://opensource.google.com/projects/pdfium" target="_blank" rel="noopener noreferrer">pdfium -- Chromium PDF 操作库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.xpdfreader.com/" target="_blank" rel="noopener noreferrer">xpdf --  开源的 PDF 浏览器<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://poppler.freedesktop.org/" target="_blank" rel="noopener noreferrer">Poppler -- 基于 xpdf 的 PDF 渲染库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p><img src="https://ravenq-1251588610.cos.ap-guangzhou.myqcloud.com/ravenq-qr-gray.png" alt="ravenq"></p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.4656d413.js" defer></script><script src="/assets/js/36.b3853710.js" defer></script>
  </body>
</html>
