<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gerrit 使用流程 | Ravenq 的技术博客</title>
    <meta name="description" content="Ravenq 的技术博客文章在Github的备份，博客请访问 http://www.aqcoder.com">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <script src="/baidu-tongji.js"></script>
    
    <link rel="preload" href="/assets/css/0.styles.3e1d0bd1.css" as="style"><link rel="preload" href="/assets/js/app.4656d413.js" as="script"><link rel="preload" href="/assets/js/4.71a39d4d.js" as="script"><link rel="prefetch" href="/assets/js/10.89ed444d.js"><link rel="prefetch" href="/assets/js/11.659c9966.js"><link rel="prefetch" href="/assets/js/12.8f4aaac0.js"><link rel="prefetch" href="/assets/js/13.c536b4f2.js"><link rel="prefetch" href="/assets/js/14.21c4f404.js"><link rel="prefetch" href="/assets/js/15.f7408336.js"><link rel="prefetch" href="/assets/js/16.a0e1f3d7.js"><link rel="prefetch" href="/assets/js/17.58743de0.js"><link rel="prefetch" href="/assets/js/18.b1abc7db.js"><link rel="prefetch" href="/assets/js/19.fdf1f22c.js"><link rel="prefetch" href="/assets/js/2.46d463bd.js"><link rel="prefetch" href="/assets/js/20.c6eb0579.js"><link rel="prefetch" href="/assets/js/21.c99260ac.js"><link rel="prefetch" href="/assets/js/22.2c7f300a.js"><link rel="prefetch" href="/assets/js/23.da0a6bc0.js"><link rel="prefetch" href="/assets/js/24.ecf5872c.js"><link rel="prefetch" href="/assets/js/25.f28d9120.js"><link rel="prefetch" href="/assets/js/26.f9920c93.js"><link rel="prefetch" href="/assets/js/27.e36352d5.js"><link rel="prefetch" href="/assets/js/28.1b9de679.js"><link rel="prefetch" href="/assets/js/29.ea5b24c0.js"><link rel="prefetch" href="/assets/js/3.a6acaedf.js"><link rel="prefetch" href="/assets/js/30.4b1b7083.js"><link rel="prefetch" href="/assets/js/31.0df5edb3.js"><link rel="prefetch" href="/assets/js/32.d2acece3.js"><link rel="prefetch" href="/assets/js/33.4da96b10.js"><link rel="prefetch" href="/assets/js/34.5a7dc727.js"><link rel="prefetch" href="/assets/js/35.652458a9.js"><link rel="prefetch" href="/assets/js/36.b3853710.js"><link rel="prefetch" href="/assets/js/37.e21463d2.js"><link rel="prefetch" href="/assets/js/38.82e5c7d6.js"><link rel="prefetch" href="/assets/js/39.9346ccd3.js"><link rel="prefetch" href="/assets/js/40.1ed88c2a.js"><link rel="prefetch" href="/assets/js/41.bef4e3c6.js"><link rel="prefetch" href="/assets/js/42.78f8a52e.js"><link rel="prefetch" href="/assets/js/43.4c5babb3.js"><link rel="prefetch" href="/assets/js/44.07ba53fd.js"><link rel="prefetch" href="/assets/js/5.d3f9f931.js"><link rel="prefetch" href="/assets/js/6.3e061d9a.js"><link rel="prefetch" href="/assets/js/7.e3dbe82f.js"><link rel="prefetch" href="/assets/js/8.f7fe650f.js"><link rel="prefetch" href="/assets/js/9.530a603c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3e1d0bd1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Ravenq 的技术博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://www.aqcoder.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/markdown-it-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  markdown-it-vue
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/vue-cli-plugin-component-lib" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue-cli-plugin-component-lib
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>GVF Project</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-server" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-server
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-client" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-client
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-admin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://www.github.com/ravenq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://www.aqcoder.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/markdown-it-vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  markdown-it-vue
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.github.com/ravenq/vue-cli-plugin-component-lib" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vue-cli-plugin-component-lib
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>GVF Project</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-server" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-server
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-client" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-client
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://www.github.com/ravenq/gvf-admin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gvf-admin
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://www.github.com/ravenq" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Gerrit 使用流程</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/blog.md/1.html#gerrit-简介" class="sidebar-link">gerrit 简介</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog.md/1.html#使用-docker-安装-gerrit" class="sidebar-link">使用 docker 安装 gerrit</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog.md/1.html#_1-pull-docker-镜像" class="sidebar-link">1. pull docker 镜像</a></li><li class="sidebar-sub-header"><a href="/blog.md/1.html#_2-启动-docker" class="sidebar-link">2. 启动 docker</a></li></ul></li><li><a href="/blog.md/1.html#注册账户" class="sidebar-link">注册账户</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog.md/1.html#_1-ssh-key（ssh-认证方式用到）" class="sidebar-link">1. ssh key（ssh 认证方式用到）</a></li><li class="sidebar-sub-header"><a href="/blog.md/1.html#_2-设置-server-host-key（ssh-认证方式用到）" class="sidebar-link">2. 设置 Server Host Key（ssh 认证方式用到）</a></li><li class="sidebar-sub-header"><a href="/blog.md/1.html#_3-设置-ssh-config-ssh-认证方式用到" class="sidebar-link">3. 设置 ssh config(ssh 认证方式用到)</a></li><li class="sidebar-sub-header"><a href="/blog.md/1.html#_4-生成-http-密码-http-认证方式用到" class="sidebar-link">4. 生成 http 密码(http 认证方式用到)</a></li></ul></li><li><a href="/blog.md/1.html#创建项目" class="sidebar-link">创建项目</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog.md/1.html#克隆项目并修改" class="sidebar-link">克隆项目并修改</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog.md/1.html#提交修改" class="sidebar-link">提交修改</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog.md/1.html#_1-git-config" class="sidebar-link">1. git config</a></li><li class="sidebar-sub-header"><a href="/blog.md/1.html#_2-设置-commit-分支" class="sidebar-link">2. 设置 commit 分支</a></li><li class="sidebar-sub-header"><a href="/blog.md/1.html#_3-设置-commit-hook" class="sidebar-link">3. 设置 commit hook</a></li><li class="sidebar-sub-header"><a href="/blog.md/1.html#_4-push-到-gerrit" class="sidebar-link">4. push 到 gerrit</a></li><li class="sidebar-sub-header"><a href="/blog.md/1.html#_5-push-认证方式" class="sidebar-link">5. push 认证方式</a></li></ul></li><li><a href="/blog.md/1.html#code-review" class="sidebar-link">code review</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="gerrit-使用流程"><a href="#gerrit-使用流程" aria-hidden="true" class="header-anchor">#</a> Gerrit 使用流程</h1> <h2 id="gerrit-简介"><a href="#gerrit-简介" aria-hidden="true" class="header-anchor">#</a> gerrit 简介</h2> <p>Gerrit，一种免费、开放源代码的代码审查软件，使用网页界面。利用网页浏览器，同一个团队的软件程序员，可以相互审阅彼此修改后的程序代码，决定是否能够提交，退回或者继续修改。它使用Git作为底层版本控制系统。它分支自Rietveld，作者为Google公司的Shawn Pearce，原先是为了管理Android计划而产生。这个软件的名称，来自于荷兰设计师赫里特·里特费尔德（Gerrit Rietveld）。最早它是由Python写成，在第二版后，改成用Java与SQL。使用Google Web Toolkit来产生前端的JavaScript。</p> <h2 id="使用-docker-安装-gerrit"><a href="#使用-docker-安装-gerrit" aria-hidden="true" class="header-anchor">#</a> 使用 docker 安装 gerrit</h2> <p>作者比较廊，安装部署是个麻烦有碰运气的时，有了 docker 这个神器后，妈妈在也不担心部署环境问题了。do
关于 docker 的使用不在本话题之内，这里只列出一些操作步骤。</p> <h3 id="_1-pull-docker-镜像"><a href="#_1-pull-docker-镜像" aria-hidden="true" class="header-anchor">#</a> 1. pull docker 镜像</h3> <div class="language-shell extra-class"><pre class="language-text"><code>docker pull gerritforge/gerrit-ubuntu15.04
</code></pre></div><h3 id="_2-启动-docker"><a href="#_2-启动-docker" aria-hidden="true" class="header-anchor">#</a> 2. 启动 docker</h3> <div class="language-shell extra-class"><pre class="language-text"><code>docker run -d -p 80:8080 -p 29418 29418 gerritforge/gerrit-ubuntu15.04
</code></pre></div><p>注意：端口映射，需要映射 29418 端口，gerrit ssh 需要用到，同时 8080 端口为 gerrit web 的端口映射为 80 端口，当然 80 端口不能被占用，护着映射为其他端口。</p> <h2 id="注册账户"><a href="#注册账户" aria-hidden="true" class="header-anchor">#</a> 注册账户</h2> <p>登录部署好的 gerrit 主页，注册账户：</p> <p><img src="http://7xjcd4.com1.z0.glb.clouddn.com/gerrit_register.png" alt="gerrit_register"></p> <p>根据要求填写账户信息，特别注意下面两项：</p> <h3 id="_1-ssh-key（ssh-认证方式用到）"><a href="#_1-ssh-key（ssh-认证方式用到）" aria-hidden="true" class="header-anchor">#</a> 1. ssh key（ssh 认证方式用到）</h3> <p>gerrit 提交时使用 ssh 协议提交代码，一次需要设置 ssh key 信息。首先，生词 ssh key:</p> <div class="language-shell extra-class"><pre class="language-text"><code>aqcoder@ubuntu:~/code/lo_core$ ssh-keygen -C aqcoder
Generating public/private rsa key pair.
Enter file in which to save the key (/home/aqcoder/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/aqcoder/.ssh/id_rsa.
Your public key has been saved in /home/aqcoder/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:LVcg70Rw4DVSVOE3o1OLkknLBD9NCi7TLYdrl2BOjLA aqcoder
The key's randomart image is:
+---[RSA 2048]----+
|    .   B=O.+.   |
|     o * &amp; B     |
|    E + @ @ + =  |
|       * % B = + |
|        S % + .  |
|       . + . .   |
|                 |
|                 |
|                 |
+----[SHA256]-----+

</code></pre></div><p>这里不需要设置密码，一路回车即可。</p> <p>将 id_rsa.pub 的内容复制到刚才注册页面的 ssh key 中。</p> <div class="language-shell extra-class"><pre class="language-text"><code>aqcoder@ubuntu:~/code/lo_core$ cat ~/.ssh/id_rsa.pub
</code></pre></div><h3 id="_2-设置-server-host-key（ssh-认证方式用到）"><a href="#_2-设置-server-host-key（ssh-认证方式用到）" aria-hidden="true" class="header-anchor">#</a> 2. 设置 Server Host Key（ssh 认证方式用到）</h3> <p>将注册页面中最下方的 Server Host Key 添加到 ~/.ssh/known_hosts 末尾</p> <div class="language-shell extra-class"><pre class="language-text"><code>echo [复制的内容] &gt;&gt; ~/.ssh/known_hosts
</code></pre></div><h3 id="_3-设置-ssh-config-ssh-认证方式用到"><a href="#_3-设置-ssh-config-ssh-认证方式用到" aria-hidden="true" class="header-anchor">#</a> 3. 设置 ssh config(ssh 认证方式用到)</h3> <div class="language-shell extra-class"><pre class="language-text"><code>vim ~/.ssh/config

Host gerrit 127.0.0.1
    IdentityFile ~/.ssh/id_rsa
    User aqcoder
    Port 29418
    HostName 127.0.0.1
</code></pre></div><h3 id="_4-生成-http-密码-http-认证方式用到"><a href="#_4-生成-http-密码-http-认证方式用到" aria-hidden="true" class="header-anchor">#</a> 4. 生成 http 密码(http 认证方式用到)</h3> <p>点击 HTTP Password --&gt; Create Password 按钮。</p> <h2 id="创建项目"><a href="#创建项目" aria-hidden="true" class="header-anchor">#</a> 创建项目</h2> <p>现在我们开始创建一个空的项目。</p> <p><img src="http://7xjcd4.com1.z0.glb.clouddn.com/gerrit_createproj.png" alt="gerrit_createproj"></p> <p>设置项目发送邮件 stmp:</p> <p>点击 project --&gt; list --&gt;  lo_coer --&gt; Edit Config</p> <p>根据你的邮箱，追加一下内容:</p> <div class="language-shell extra-class"><pre class="language-text"><code>[sendemail]
        enable = true
        smtpServer = smtp.gmail.com
        smtpServerPort = 465
        smtpEncryption = ssl
        smtpUser = your_account@gmail..com
        smtpPass = your_password
        sslVerify = false
        from = Code Review &lt; your_account@gmail..com&gt;
</code></pre></div><h2 id="克隆项目并修改"><a href="#克隆项目并修改" aria-hidden="true" class="header-anchor">#</a> 克隆项目并修改</h2> <p>将刚才创建的项目克隆岛本地：</p> <div class="language-shell extra-class"><pre class="language-text"><code>aqcoder@ubuntu:~/code$ sudo git clone http://127.0.0.1/lo_core
Cloning into 'lo_core'...
remote: Counting objects: 2, done
remote: Finding sources: 100% (2/2)
remote: Total 2 (delta 0), reused 0 (delta 0)
Unpacking objects: 100% (2/2), done.
Checking connectivity... done.

</code></pre></div><p>为了演示效果，我们在这里就添加一个 test 文件，在实际项目中添加您要管理的代码。当然也可以使用命令来直接添加已经在 git 管理下的本地仓库同时创建项目。</p> <div class="language-shell extra-class"><pre class="language-text"><code>aqcoder@ubuntu:~/code/lo_core$ touch test
aqcoder@ubuntu:~/code/lo_core$ git add .
aqcoder@ubuntu:~/code/lo_core$ git commit -m&quot;test&quot;
</code></pre></div><h2 id="提交修改"><a href="#提交修改" aria-hidden="true" class="header-anchor">#</a> 提交修改</h2> <h3 id="_1-git-config"><a href="#_1-git-config" aria-hidden="true" class="header-anchor">#</a> 1. git config</h3> <p>注意：提交者必须和 geriit 注册的邮箱一致</p> <div class="language-shell extra-class"><pre class="language-text"><code>git config user.name aqcoder
git config user.email flw.aquarius@gmail.com
</code></pre></div><h3 id="_2-设置-commit-分支"><a href="#_2-设置-commit-分支" aria-hidden="true" class="header-anchor">#</a> 2. 设置 commit 分支</h3> <p>gerrit 不允许用户直接向 master 分支直接 push 代码，只能想 push 到分支，然后经过 review 以后再合并，这个也是 review 的精髓所在。</p> <div class="language-shell extra-class"><pre class="language-text"><code>aqcoder@ubuntu:~/code/lo_core$ git config remote.origin.push refs/heads/*:refs/for/*
</code></pre></div><h3 id="_3-设置-commit-hook"><a href="#_3-设置-commit-hook" aria-hidden="true" class="header-anchor">#</a> 3. 设置 commit hook</h3> <p>gerrit 中使用 change-id 做为一个 patch 的提交，也就说当你在修改一个 bug 或完成一个功能时，可能有多次的提交，但是他们应该使用一个 change-id。这使得提交历史干净明了，易于撤销 patch。因此，在每次提交时需要使用 hook 生成 chang-id,当需要往这个 patch 进行第二次提交时使用 <code>git --amend</code> 再次提交。</p> <div class="language-shell extra-class"><pre class="language-text"><code>aqcoder@ubuntu:~/code/lo_core$ gitdir=$(git rev-parse --git-dir); scp -p -P 29418 aqcoder@127.0.0.1:hooks/commit-msg ${gitdir}/hooks/
commit-msg                                    100% 4662     4.6KB/s   00:00
</code></pre></div><h3 id="_4-push-到-gerrit"><a href="#_4-push-到-gerrit" aria-hidden="true" class="header-anchor">#</a> 4. push 到 gerrit</h3> <p>由于上面的提交我们没有 change-d 因此，在这里在进行一次提交操作。</p> <div class="language-shell extra-class"><pre class="language-text"><code>aqcoder@ubuntu:~/code/lo_core$ git commit --amend
[master 0e0fc03] test
 Date: Sun Apr 10 19:20:45 2016 +0800
 1 file changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 test
</code></pre></div><p>现在可以 push 了（push  的时候有 http 和 ssh 两种认证方式，这里使用了 http 的方式，两种方式说明详见下面 push 认证方式）。</p> <div class="language-shell extra-class"><pre class="language-text"><code>aqcoder@ubuntu:~/code/lo_core$ git push
Username for 'http://127.0.0.1': aqcoder
Password for 'http://127.0.0.1':
Counting objects: 3, done.
Writing objects: 100% (3/3), 275 bytes | 0 bytes/s, done.
Total 3 (delta 0), reused 0 (delta 0)
remote: Processing changes: new: 1, refs: 1, done
remote:
remote: New Changes:
remote:   http://bcad5a346f31:8080/34 test
remote:
To http://gerrit.zysoft.com/lo_core
 * [new branch]      master -&gt; refs/for/master

</code></pre></div><p>提交成功，现在登录 grrit，可以看到你的修改了：</p> <p><img src="http://7xjcd4.com1.z0.glb.clouddn.com/gerrit_push.png" alt="gerrit_push"></p> <h3 id="_5-push-认证方式"><a href="#_5-push-认证方式" aria-hidden="true" class="header-anchor">#</a> 5. push 认证方式</h3> <p>两种的设置在我们的上面的注册步骤已经完成了。</p> <ol><li>http 的认证方式理解起来比较简单，通过用户名密码认证。 使用注册步骤中生成的密码即可通过验证。</li></ol> <p>gerrit 的 HTTP 密码不能修改，每次输入比较麻烦。可以设置 git 缓存此密码：<code>git config --global credential.helper store</code>
2. ssh 方式验证。注册步骤我们已经完成了公钥秘钥的设置，现在还需要设置 push url</p> <div class="language-shell extra-class"><pre class="language-text"><code>git remote set-url origin ssh://127.0.0.1/lo_core
</code></pre></div><p>如果 push 的时候出现 Permission Denied</p> <div class="language-shell extra-class"><pre class="language-text"><code>aqcoder@ubuntu:~/code/lo_core$ git push
Permission denied (publickey).
fatal: Could not read from remote repository.
Please make sure you have the correct access rights
and the repository exists.
</code></pre></div><p>尝试执行</p> <div class="language-shell extra-class"><pre class="language-text"><code>aqcoder@ubuntu:~/code/test$ ssh-add ~/.ssh/id_rsa
Identity added: /home/aqcoder/.ssh/id_rsa (/homeaqcoder/.ssh/id_rsa)
</code></pre></div><h2 id="code-review"><a href="#code-review" aria-hidden="true" class="header-anchor">#</a> code review</h2> <p>登录管理员账户，找到刚才的提交。进行代码审核，审核通过后，点击 review, merge patch 到 master。这样一次代码审核就完成了。</p> <p><img src="http://7xjcd4.com1.z0.glb.clouddn.com/gerrit_review.png" alt="gerrit_review"></p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.4656d413.js" defer></script><script src="/assets/js/4.71a39d4d.js" defer></script>
  </body>
</html>
