(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{198:function(a,t,i){"use strict";i.r(t);var e=i(0),n=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{staticClass:"content"},[i("h1",{attrs:{id:"gitlab-nginx-代理后-forbidden-403-错误处理"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#gitlab-nginx-代理后-forbidden-403-错误处理","aria-hidden":"true"}},[a._v("#")]),a._v(" gitlab nginx 代理后 Forbidden 403 错误处理")]),a._v(" "),i("h2",{attrs:{id:"环境："}},[i("a",{staticClass:"header-anchor",attrs:{href:"#环境：","aria-hidden":"true"}},[a._v("#")]),a._v(" 环境：")]),a._v(" "),i("ul",[i("li",[a._v("使用 docker 启动的 gitlab 服务，端口为 8080")]),a._v(" "),i("li",[a._v("在同一台机器上使用 nginx 反向代理 8080 端口为 80 端口")])]),a._v(" "),i("h2",{attrs:{id:"现象："}},[i("a",{staticClass:"header-anchor",attrs:{href:"#现象：","aria-hidden":"true"}},[a._v("#")]),a._v(" 现象：")]),a._v(" "),i("p",[a._v("不定时的出现 Forbidden 错误")]),a._v(" "),i("h2",{attrs:{id:"解决方案"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#解决方案","aria-hidden":"true"}},[a._v("#")]),a._v(" 解决方案")]),a._v(" "),i("p",[a._v("开始以为是 nginx 的问题，尝试了各种 nginx 配置修改，权限修改，都不行。")]),a._v(" "),i("p",[a._v("经过网上的一些资料搜索，发现是 gitlab 的问题。")]),a._v(" "),i("p",[a._v("gitlab 有个限制同一 ip 用错误的用户名密码单位时间内多次访问 gitlab 的限制。")]),a._v(" "),i("p",[a._v("找到原因就好解决了： 修改 gitlab/config/gitlab.rb 配置文件,吧 nginx ip 地址加入白名单")]),a._v(" "),i("div",{staticClass:"language-rb extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[a._v("gitlab_rails['rack_attack_git_basic_auth'] = {\n   'enabled' => true,\n   'ip_whitelist' => [\"127.0.0.1\",\"<你的 nginx 机器 ip>\",\"localhost\"],\n   'maxretry' => 10,\n   'findtime' => 60,\n   'bantime' => 3600\n}\n")])])]),i("p",[a._v("或者直接禁用此项功能。")]),a._v(" "),i("div",{staticClass:"language-rb extra-class"},[i("pre",{pre:!0,attrs:{class:"language-text"}},[i("code",[a._v("gitlab_rails['rack_attack_git_basic_auth'] = {\n   'enabled' => false,\n   'ip_whitelist' => [\"127.0.0.1\"],\n   'maxretry' => 10,\n   'findtime' => 60,\n   'bantime' => 3600\n}\n")])])])])}],!1,null,null,null);t.default=n.exports}}]);